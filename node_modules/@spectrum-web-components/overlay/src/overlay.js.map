{
  "version": 3,
  "sources": ["overlay.ts"],
  "sourcesContent": ["/*\nCopyright 2020 Adobe. All rights reserved.\nThis file is licensed to you under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License. You may obtain a copy\nof the License at http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software distributed under\nthe License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\nOF ANY KIND, either express or implied. See the License for the specific language\ngoverning permissions and limitations under the License.\n*/\n\nimport type { ThemeData } from '@spectrum-web-components/theme/src/Theme.js';\nimport type {\n    OverlayDisplayQueryDetail,\n    OverlayOptions,\n    TriggerInteractions,\n} from './overlay-types';\nimport { OverlayStack } from './overlay-stack.js';\n\n/**\n * This class allows access to the overlay system which allows a client to\n * position an element in the overlay positioned relative to another node.\n */\nexport class Overlay {\n    private static overlayStack = new OverlayStack();\n\n    private isOpen = false;\n    private overlayElement: HTMLElement;\n    private owner: HTMLElement;\n    private interaction: TriggerInteractions;\n\n    /**\n     *\n     * @param owner the parent element we will use to position the overlay element\n     * @param interaction the type of interaction that caused this overlay to be shown\n     * @param overlayElement the item to display as an overlay\n     */\n    constructor(\n        owner: HTMLElement,\n        interaction: TriggerInteractions,\n        overlayElement: HTMLElement\n    ) {\n        this.owner = owner;\n        this.overlayElement = overlayElement;\n        this.interaction = interaction;\n    }\n\n    /**\n     * Open an overlay\n     *\n     * @param owner the parent element we will use to position the overlay element\n     * @param interaction the type of interaction that caused this overlay to be shown\n     * @param overlayElement the item to display as an overlay\n     * @param options display parameters\n     * @param options.delayed if true delay opening of the overlay based on the global warmup/cooldown timer\n     * @param options.offset distance to offset the overlay\n     * @param options.placement side on which to position the overlay\n     * @returns an Overlay object which can be used to close the overlay\n     */\n    public static async open(\n        owner: HTMLElement,\n        interaction: TriggerInteractions,\n        overlayElement: HTMLElement,\n        options: OverlayOptions\n    ): Promise<() => void> {\n        const overlay = new Overlay(owner, interaction, overlayElement);\n        if (window.__swc.DEBUG) {\n            window.__swc.warn(\n                undefined,\n                'The Overlay API is currently being refactored and there are likely to be breaking changes, deprecations and/or removals in a future release. The SWC team wants feedback from direct Overlay API consumers like you - please share your thoughts on the future of overlays here:',\n                'https://github.com/adobe/spectrum-web-components/discussions/2764',\n                {\n                    type: 'default',\n                    level: 'deprecation',\n                }\n            );\n        }\n        await overlay.open(options);\n        return (): void => {\n            overlay.close();\n        };\n    }\n\n    public static update(): void {\n        const overlayUpdateEvent = new CustomEvent('sp-update-overlays', {\n            bubbles: true,\n            composed: true,\n            cancelable: true,\n        });\n        document.dispatchEvent(overlayUpdateEvent);\n    }\n\n    /**\n     * Open an overlay\n     *\n     * @param options display parameters\n     * @param options.delayed delay before opening the overlay\n     * @param options.offset distance to offset the overlay\n     * @param options.placement side on which to position the overlay\n     * @returns a Promise that resolves to true if this operation was cancelled\n     */\n    public async open({\n        abortPromise,\n        delayed,\n        offset = 0,\n        placement = 'top',\n        receivesFocus,\n        notImmediatelyClosable,\n        virtualTrigger,\n        root,\n    }: OverlayOptions): Promise<boolean> {\n        /* c8 ignore next */\n        if (this.isOpen) return true;\n\n        if (delayed === undefined) {\n            delayed = this.overlayElement.hasAttribute('delayed');\n        }\n\n        const queryThemeDetail: ThemeData = {\n            color: undefined,\n            scale: undefined,\n            lang: undefined,\n            theme: undefined,\n        };\n        const queryThemeEvent = new CustomEvent<ThemeData>('sp-query-theme', {\n            bubbles: true,\n            composed: true,\n            detail: queryThemeDetail,\n            cancelable: true,\n        });\n        this.owner.dispatchEvent(queryThemeEvent);\n\n        const overlayDetailQuery: OverlayDisplayQueryDetail = {};\n        const queryOverlayDetailEvent =\n            new CustomEvent<OverlayDisplayQueryDetail>('sp-overlay-query', {\n                bubbles: true,\n                composed: true,\n                detail: overlayDetailQuery,\n                cancelable: true,\n            });\n        this.overlayElement.dispatchEvent(queryOverlayDetailEvent);\n\n        await Overlay.overlayStack.openOverlay({\n            abortPromise,\n            content: this.overlayElement,\n            contentTip: overlayDetailQuery.overlayContentTipElement,\n            delayed,\n            offset: offset,\n            placement: placement,\n            trigger: this.owner,\n            interaction: this.interaction,\n            theme: queryThemeDetail,\n            receivesFocus,\n            root,\n            notImmediatelyClosable,\n            virtualTrigger,\n            ...overlayDetailQuery,\n        });\n        this.isOpen = true;\n        return true;\n    }\n\n    /**\n     * Close the overlay if it is open\n     */\n    public close(): void {\n        Overlay.overlayStack.closeOverlay(this.overlayElement);\n    }\n}\n\n/**\n * Announces that an overlay-based UI element has opened\n * @event sp-open\n * @type {object}\n * @property {TriggerInteractions} interaction type of interaction that triggered the opening\n */\n\n/**\n * Announces that an overlay-based UI element has opened\n * @event sp-close\n * @type {object}\n * @property {TriggerInteractions} interaction type of interaction that triggered the closing\n */\n"],
  "mappings": "aAkBA,OAAS,gBAAAA,MAAoB,qBAMtB,MAAMC,EAAN,KAAc,CAcjB,YACIC,EACAC,EACAC,EACF,CAfF,KAAQ,OAAS,GAgBb,KAAK,MAAQF,EACb,KAAK,eAAiBE,EACtB,KAAK,YAAcD,CACvB,CAcA,aAAoB,KAChBD,EACAC,EACAC,EACAC,EACmB,CACnB,MAAMC,EAAU,IAAIL,EAAQC,EAAOC,EAAaC,CAAc,EAY9D,aAAME,EAAQ,KAAKD,CAAO,EACnB,IAAY,CACfC,EAAQ,MAAM,CAClB,CACJ,CAEA,OAAc,QAAe,CACzB,MAAMC,EAAqB,IAAI,YAAY,qBAAsB,CAC7D,QAAS,GACT,SAAU,GACV,WAAY,EAChB,CAAC,EACD,SAAS,cAAcA,CAAkB,CAC7C,CAWA,MAAa,KAAK,CACd,aAAAC,EACA,QAAAC,EACA,OAAAC,EAAS,EACT,UAAAC,EAAY,MACZ,cAAAC,EACA,uBAAAC,EACA,eAAAC,EACA,KAAAC,CACJ,EAAqC,CAEjC,GAAI,KAAK,OAAQ,MAAO,GAEpBN,IAAY,SACZA,EAAU,KAAK,eAAe,aAAa,SAAS,GAGxD,MAAMO,EAA8B,CAChC,MAAO,OACP,MAAO,OACP,KAAM,OACN,MAAO,MACX,EACMC,EAAkB,IAAI,YAAuB,iBAAkB,CACjE,QAAS,GACT,SAAU,GACV,OAAQD,EACR,WAAY,EAChB,CAAC,EACD,KAAK,MAAM,cAAcC,CAAe,EAExC,MAAMC,EAAgD,CAAC,EACjDC,EACF,IAAI,YAAuC,mBAAoB,CAC3D,QAAS,GACT,SAAU,GACV,OAAQD,EACR,WAAY,EAChB,CAAC,EACL,YAAK,eAAe,cAAcC,CAAuB,EAEzD,MAAMlB,EAAQ,aAAa,YAAY,CACnC,aAAAO,EACA,QAAS,KAAK,eACd,WAAYU,EAAmB,yBAC/B,QAAAT,EACA,OAAQC,EACR,UAAWC,EACX,QAAS,KAAK,MACd,YAAa,KAAK,YAClB,MAAOK,EACP,cAAAJ,EACA,KAAAG,EACA,uBAAAF,EACA,eAAAC,EACA,GAAGI,CACP,CAAC,EACD,KAAK,OAAS,GACP,EACX,CAKO,OAAc,CACjBjB,EAAQ,aAAa,aAAa,KAAK,cAAc,CACzD,CACJ,EAjJO,WAAM,QAANA,EAAM,QACM,aAAe,IAAID",
  "names": ["OverlayStack", "_Overlay", "owner", "interaction", "overlayElement", "options", "overlay", "overlayUpdateEvent", "abortPromise", "delayed", "offset", "placement", "receivesFocus", "notImmediatelyClosable", "virtualTrigger", "root", "queryThemeDetail", "queryThemeEvent", "overlayDetailQuery", "queryOverlayDetailEvent"]
}
