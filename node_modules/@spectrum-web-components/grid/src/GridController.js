"use strict";import{ResizeController as h}from"@lit-labs/observers/resize-controller.js";import{RovingTabindexController as d}from"@spectrum-web-components/reactive-controllers/src/RovingTabindex.js";export class GridController{constructor(t,{elements:e,itemSize:i,gap:n,padding:s}){this._first=0;this._last=0;this.handleFocusin=t=>{const e=s=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{s()})})},i=()=>this.host.scrollToIndex(0),n=()=>{this.focus(),this.host.tabIndex=-1};t.target===this.host&&(this._first>0?e(()=>{i(),e(n)}):e(n))};this.handleFocusout=t=>{(!t.relatedTarget||!this.host.contains(t.relatedTarget))&&(this.host.tabIndex=0)};this.handleRangeChanged=t=>{this.rovingTabindexController.clearElementCache(t.first)};this.handleVisibleChanged=t=>{this._first=t.first,this._last=t.last};this.host=t,this.host.addController(this),this.applyLayout(i,n,s),this.resizeController=new h(this.host,{callback:o=>{o.forEach(r=>{this.measureDirectionLength(r.contentRect)})}}),this.rovingTabindexController=new d(this.host,{direction:"grid",elements:e,focusInIndex:()=>this.host.getRootNode().activeElement===this.host?0:-1})}get itemSize(){return this._itemSize()}_itemSize(){return{width:100,height:100}}get gap(){return this._gap()}_gap(){}get padding(){return this._padding()}_padding(){}focus(t){this.rovingTabindexController.focus(t)}applyLayout(t,e,i){typeof t=="object"?this._itemSize=()=>t:typeof t=="function"&&typeof t()!="undefined"&&(this._itemSize=t),typeof e=="string"?this._gap=()=>e:typeof e=="function"&&(this._gap=e),typeof i=="string"?this._padding=()=>i:typeof i=="function"&&(this._padding=i)}update({elements:t,itemSize:e,gap:i,padding:n}){this.rovingTabindexController.update({elements:t}),this.applyLayout(e,i,n);const s=this.host.getBoundingClientRect();this.measureDirectionLength(s)}measureDirectionLength(t){const e=this.gap?parseFloat(this.gap):0,i=this.padding?parseFloat(this.padding):0,n=t.width-i*2,s=Math.floor((n-this.itemSize.width)/(e+this.itemSize.width))+1;this.rovingTabindexController.directionLength=Math.floor(s)}hostConnected(){this.host.addEventListener("rangeChanged",this.handleRangeChanged),this.host.addEventListener("visibilityChanged",this.handleVisibleChanged),this.host.addEventListener("focusin",this.handleFocusin),this.host.addEventListener("focusout",this.handleFocusout),this.host.tabIndex=0,this.host.style.setProperty("outline","none","important")}hostDisconnected(){this.host.removeEventListener("rangeChanged",this.handleRangeChanged),this.host.removeEventListener("visibilityChanged",this.handleVisibleChanged),this.host.removeEventListener("focusin",this.handleFocusin),this.host.removeEventListener("focusout",this.handleFocusout)}}
//# sourceMappingURL=GridController.js.map
