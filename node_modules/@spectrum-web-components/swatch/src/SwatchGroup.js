"use strict";var d=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var l=(c,a,e,t)=>{for(var i=t>1?void 0:t?h(a,e):a,s=c.length-1,r;s>=0;s--)(r=c[s])&&(i=(t?r(a,e,i):r(i))||i);return t&&i&&d(a,e,i),i};import{html as u,SizedMixin as p,SpectrumElement as S}from"@spectrum-web-components/base";import{property as o}from"@spectrum-web-components/base/src/decorators.js";import{RovingTabindexController as f}from"@spectrum-web-components/reactive-controllers/src/RovingTabindex.js";import{MutationController as g}from"@lit-labs/observers/mutation-controller.js";import w from"./swatch-group.css.js";export class SwatchGroup extends p(S,{validSizes:["xs","s","m","l"],noDefaultSize:!0}){constructor(){super();this.selected=[];this.selectedSet=new Set;this.rovingTabindexController=new f(this,{focusInIndex:e=>{let t=-1;const i=e.findIndex((s,r)=>(!e[t]&&!s.disabled&&(t=r),s.selected&&!s.disabled));return e[i]?i:t},elements:()=>[...this.children],isFocusableElement:e=>!e.disabled});this.manageChange=()=>{const e=new Set;this.selectedSet=new Set(this.selected),[...this.children].forEach(i=>{e.add(i.value),i.selected&&this.selectedSet.add(i.value)}),this.selectedSet.forEach(i=>{e.has(i)||this.selectedSet.delete(i)}),this.selected=[...this.selectedSet]};new g(this,{config:{attributes:!0,childList:!0,subtree:!0},callback:()=>{this.manageChange()}})}static get styles(){return[w]}focus(e){this.rovingTabindexController.focus(e)}handleChange(e){e.stopPropagation();const t=this.selected;if(!this.selects){e.preventDefault();return}if(this.selects==="single"){const{target:s}=e;if(s.tabIndex=0,s.selected=!0,this.selectedSet.has(s.value))return;this.selectedSet.clear(),this.selectedSet.add(s.value),this.rovingTabindexController.elements.forEach(r=>{r!==s&&(r.selected=!1)})}else if(this.selects==="multiple"){const{target:s}=e;s.selected?this.selectedSet.add(s.value):this.selectedSet.delete(s.value)}this.selected=[...this.selectedSet],this.dispatchEvent(new Event("change",{cancelable:!0,bubbles:!0}))||(this.selected=t,e.preventDefault())}getPassthroughSwatchActions(e){const t={};e.has("selects")&&(this.selects||typeof e.get("selects")!="undefined")&&(t.selects=this.selects),e.has("border")&&(this.border||typeof e.get("border")!="undefined")&&(t.border=this.border),e.has("rounding")&&(this.rounding||typeof e.get("rounding")!="undefined")&&(t.rounding=this.rounding),e.has("size")&&(this.size!=="m"||typeof e.get("size")!="undefined")&&(t.size=this.size),e.has("shape")&&(this.shape||typeof e.get("shape")!="undefined")&&(t.shape=this.shape);const i=[];return Object.keys(t).length&&i.push(s=>{"border"in t&&(s.border=t.border),"rounding"in t&&(s.rounding=t.rounding),"shape"in t&&(s.shape=t.shape),"size"in t&&(s.size=t.size)}),i}getSelectionSwatchActions(e){const t=[];if(!e.has("selects"))return t;this.selects?this.setAttribute("role",this.selects==="single"?"radiogroup":"group"):this.removeAttribute("role");const i={single:"radio",multiple:"checkbox"},s=this.selects?i[this.selects]:"button";return t.push(r=>{r.setAttribute("role",s)}),t}render(){return u`
            <slot
                @change=${this.handleChange}
                @slotchange=${this.manageChange}
            ></slot>
        `}willUpdate(e){const t=[...this.getPassthroughSwatchActions(e),...this.getSelectionSwatchActions(e)],i=new Set(this.selected),s=new Set;e.has("selected")&&t.push(r=>{s.add(r.value),i.has(r.value)||!this.hasUpdated&&r.selected?r.selected=!0:r.selected=!1}),this.rovingTabindexController.elements.forEach(r=>{t.forEach(n=>{n(r)})}),e.has("selected")&&(this.selected=[...i].filter(r=>s.has(r)),this.rovingTabindexController.clearElementCache())}}l([o({reflect:!0})],SwatchGroup.prototype,"border",2),l([o({reflect:!0})],SwatchGroup.prototype,"rounding",2),l([o({type:Array})],SwatchGroup.prototype,"selected",2),l([o()],SwatchGroup.prototype,"selects",2),l([o({reflect:!0})],SwatchGroup.prototype,"shape",2),l([o({reflect:!0})],SwatchGroup.prototype,"density",2);
//# sourceMappingURL=SwatchGroup.js.map
